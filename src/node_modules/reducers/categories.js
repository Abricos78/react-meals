const GET_CATEGORIES_START = 'GET_CATEGORIES_START'
const GET_CATEGORIES_SUCCESS = 'GET_CATEGORIES_SUCCESS'
const GET_CATEGORIES_FAILURE = 'GET_CATEGORIES_FAILURE'
const CHANGE_SEARCH = 'CHANGE_SEARCH'

import {getCategories as getCategoriesApi} from 'api'

let initialState = {
    categories: [],
    search: '',
    loading: false
}

export const categories = (state = initialState, { type, payload }) => {
    switch (type) {
        case GET_CATEGORIES_START:
            return {
                ...state,
                loading: true
            }
        case GET_CATEGORIES_SUCCESS:
            return {
                ...state,
                loading: false,
                categories: payload
            }
        case CHANGE_SEARCH:
            return {
                ...state,
                search: payload
            }
        default:
            return state
    }
}

export const getCategories = () => async dispatch => {
    dispatch({
        type: GET_CATEGORIES_START
    })
    try {
        const categories = await getCategoriesApi()
        dispatch({
            type: GET_CATEGORIES_SUCCESS,
            payload: categories
        })
    } catch (err) {
        dispatch({
            type: GET_CATEGORIES_FAILURE,
            payload: err,
            error: true
        })
    }
}

export const changeSearch = value => dispatch => {
    dispatch({
        type: CHANGE_SEARCH,
        payload: value
    })
}