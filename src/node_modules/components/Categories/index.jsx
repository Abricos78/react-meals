import React, { useEffect } from 'react'
import { connect } from 'react-redux'

import { 
    getCategories as getCategoriesSelector,
    getLoading
} from 'selectors'
import { getCategories } from 'reducers/categories'
import Preloader from 'components/Preloader'
import CategoryItem from 'components/Categories/CategoryItem'
import Search from 'components/Search'

function Categories({categories, loading, getCategories, history}) {

    useEffect(() => getCategories(),[])

    return (
        <>
            <Search history={history} />
            <section className='categories'>
                { loading ?
                    <Preloader />
                :
                    categories.map(category => <CategoryItem key={category.idCategory} {...category} />)
                }
            </section>
        </>

    )
}

let mapStateToProps = state => {
    return {
        categories: getCategoriesSelector(state),
        loading: getLoading(state, 'categories')
    }
},
mapDispatchToProps = {
    getCategories
}

export default connect(mapStateToProps, mapDispatchToProps)(Categories)
